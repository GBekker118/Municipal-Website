@model PROG7312_POE.Models.ReportIssue

@{
    ViewData["Title"] = "ReportIssues";
}

<style>
    /* Background image */
    body {
        background-image: url('/img/slide2.jpg');
        background-size: cover;
        background-repeat: no-repeat;
        background-position: center;
        margin: 0;
        padding: 0;
    }
    
    /* Form */
    .form {
        max-width: 100vw;
        width: 100%;
        background-color: white;
        box-shadow: 1px 1px 10px 1px black;
        padding-left: 3%;
        padding-right: 3%;
        padding-top: 2%;
        padding-bottom: 2%;
        border-radius: 5px;
        font-size: 20px;
        font-weight: bold;
    }

    .form-title {
        position: relative;
        text-align: center;
        margin-bottom: 15px;
    }

    .form-title h2 {
        margin: 0;
        font-size: 40px;
    }

    .form-logo {
        position: absolute;
        top: 0;
        right: 0;
        width: 85px;
        height: 70px;
        border-radius: 5px;
        border: 2px solid black;
    }

    /* Button */
    .submit {
        font-weight: bold;
        box-shadow: 2px 2px 4px 2px black;
        width:80%;
    }

    .submit:hover {
        transform: scale(1.1);
    }

    /* Back Button */
    .back-button {
        position: absolute;
        left: 0; 
        top: 50%;
        transform: translateY(-50%);
        font-size: 25px;
        text-decoration: none;
        box-shadow: 1px 1px 2px 1px black;
        border-radius: 100px;
        padding: 2px 10px;
        background-color: rgba(69, 165, 217, 0.8);
        color:white;
        font-weight:bold;
        padding-bottom:5px;
    }

    .back-button:hover {
        color: white;
        background-color: rgba(69, 165, 217, 1.0);
        transform: translateY(-50%) scale(1.1); 
    }
</style>

<div class="row" style="justify-content:center; margin-top:0;">
    <div class="col-md-10">
        <!-- Report Issue Form -->
        <form asp-action="ReportIssues" method="post" enctype="multipart/form-data" class="form" style="background-image:url('');background-repeat:no-repeat; background-size: contain;background-position:center">
            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <!-- Back Button + Title -->
            <div class="form-title">
                <a class="back-button" asp-controller="Home" asp-action="Index">&#10094;-</a>
                <h2>Report Issues Form:</h2>
                <img src="~/img/logo.png" alt="logo" class="form-logo" />
            </div>

            <!-- Progressbar + Status Label -->
            <div class="form-group text-center">
                <progress id="engagementProgress" value="0" max="4" style="width:100%;height:50px;accent-color:#049854"></progress>
                <label id="engagementLabel" style="font-size:25px; color: #629EF8; font-weight:bold; display:block;">
                    Please fill in the fields below.
                </label>
            </div>

            <!-- Form Inputs -->
            <div class="row mt-3">
                <!-- LEFT: Location, Category, Media -->
                <div class="col-md-6 order-md-1">
                    <div class="form-group">
                        <label asp-for="Location">Location:</label>
                        <input asp-for="Location" id="Location" class="form-control" style="background-color: rgba(69, 165, 217, 0.8); color:black; margin-bottom: 15px;font-weight:bold;" />
                        <span asp-validation-for="Location" class="text-danger"></span>
                    </div>
                    <div class="form-group">
                        <label asp-for="Category">Category:</label>
                        <select asp-for="Category" id="Category" class="form-control" style="background-color: rgba(69, 165, 217, 0.8); color:black; margin-bottom: 15px;font-weight:bold;">
                            <option value="">--Select Category--</option>
                            <option>Sanitation</option>
                            <option>Roads</option>
                            <option>Utilities</option>
                        </select>
                        <span asp-validation-for="Category" class="text-danger"></span>
                    </div>

                    <div class="form-group">
                        <label>Attach Media:</label>
                        <input asp-for="Media" type="file" id="Media" name="mediaFile" class="form-control" style="background-color: rgba(69, 165, 217, 0.8); color:black; margin-bottom: 15px;font-weight:bold;" required />
                        <span asp-validation-for="Media" class="text-danger"></span>
                    </div>
                </div>

                <!-- RIGHT: Description -->
                <div class="col-md-6 order-md-2">
                    <div class="form-group">
                        <label asp-for="Description">Description:</label>
                        <textarea asp-for="Description" id="Description" class="form-control" rows="8" style="background-color: rgba(69, 165, 217, 0.8); color:black;font-weight:bold;"></textarea>
                        <span asp-validation-for="Description" class="text-danger"></span>
                    </div>
                </div>
            </div>

            <!-- Submit Button -->
            <div class="form-group text-center mt-4">
                <input type="submit" value="Submit Report Issue" class="submit btn btn-primary px-4 py-2" style="box-shadow:1px 1px 2px 1px black;" required />
            </div>
        </form>
    </div>
</div>
<br />
@section Scripts {
    @{
        await Html.RenderPartialAsync("_ValidationScriptsPartial");
    }
    
    <script>
        const locationInput = document.getElementById('Location');
        const categorySelect = document.getElementById('Category');
        const descriptionInput = document.getElementById('Description');
        const mediaInput = document.getElementById('Media');
        const engagementLabel = document.getElementById('engagementLabel');
        const engagementProgress = document.getElementById('engagementProgress');

        // JavaScript Function for dynamic progressbar and message
        function updateEngagement() {
            let filled = 0;

            if (locationInput.value.trim() !== '') filled++;
            if (categorySelect.value.trim() !== '') filled++;
            if (descriptionInput.value.trim() !== '') filled++;
            if (mediaInput.files.length > 0) filled++; 

            switch (filled) {
                case 0:
                    engagementLabel.textContent = "Please fill in the fields below.";
                    break;
                case 1:
                    engagementLabel.textContent = "One field has been completed.";
                    break;
                case 2:
                    engagementLabel.textContent = "Two fields have been completed.";
                    break;
                case 3:
                    engagementLabel.textContent = "Three fields completed.";
                    break;
                case 4:
                    engagementLabel.textContent = "All fields completed. Ready to submit!";
                    break;
            }

            engagementProgress.value = filled;
        }

        locationInput.addEventListener('input', updateEngagement);
        categorySelect.addEventListener('change', updateEngagement);
        descriptionInput.addEventListener('input', updateEngagement);
        mediaInput.addEventListener('change', updateEngagement);
    </script>
}
<!-- References:
    AlexB (2014). Displaying a progress bar showing the progress of a form submission. [online] Stack Overflow. Available at: https://stackoverflow.com/questions/21902385/displaying-a-progress-bar-showing-the-progress-of-a-form-submission.
    www.w3schools.com. (n.d.). How To Create a Skill Bar CSS. [online] Available at: https://www.w3schools.com/howto/howto_css_skill_bar.asp.
    www.w3schools.com. (n.d.). How TO JS Progress Bar. [online] Available at: https://www.w3schools.com/howto/howto_js_progressbar.asp.‌
-->